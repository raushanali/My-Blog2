<%- include('partials/header') %>

<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card shadow">
            <div class="card-header bg-warning text-dark">
                <h2 class="mb-0">
                    <i class="fas fa-edit me-2"></i>Edit Blog Post
                </h2>
            </div>
            
            <div class="card-body">
                <% if (errors && errors.length > 0) { %>
                    <div class="alert alert-danger">
                        <h6><i class="fas fa-exclamation-circle me-2"></i>Please fix the following errors:</h6>
                        <ul class="mb-0">
                            <% errors.forEach(error => { %>
                                <li><%= error %></li>
                            <% }); %>
                        </ul>
                    </div>
                <% } %>

                <form method="POST" action="/posts/<%= post.id %>?_method=PUT">
                    <div class="mb-3">
                        <label for="title" class="form-label">
                            <i class="fas fa-heading me-2"></i>Post Title *
                        </label>
                        <input 
                            type="text" 
                            class="form-control form-control-lg" 
                            id="title" 
                            name="title" 
                            placeholder="Enter an engaging title for your blog post"
                            value="<%= post.title %>"
                            required
                        >
                        <div class="form-text">Make it catchy and descriptive!</div>
                    </div>

                    <div class="mb-3">
                        <label for="author" class="form-label">
                            <i class="fas fa-user me-2"></i>Author *
                        </label>
                        <input 
                            type="text" 
                            class="form-control" 
                            id="author" 
                            name="author" 
                            placeholder="Your name"
                            value="<%= post.author %>"
                            required
                        >
                    </div>

                    <div class="mb-4">
                        <label for="content" class="form-label">
                            <i class="fas fa-align-left me-2"></i>Post Content *
                        </label>
                        <textarea 
                            class="form-control" 
                            id="content" 
                            name="content" 
                            rows="10" 
                            placeholder="Share your thoughts, ideas, and stories here..."
                            required
                        ><%= post.content %></textarea>
                        <div class="form-text">Update your blog post content here.</div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-between">
                        <div>
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                Originally created on <%= formatDate(post.createdAt) %>
                                <% if (post.updatedAt) { %>
                                    <br>Last updated on <%= formatDate(post.updatedAt) %>
                                <% } %>
                            </small>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex">
                            <a href="/" class="btn btn-outline-secondary btn-lg me-md-2">
                                <i class="fas fa-times me-2"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-warning btn-lg">
                                <i class="fas fa-save me-2"></i>Update Post
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-eye me-2"></i>Current Post Preview
                </h5>
            </div>
            <div class="card-body">
                <h4 class="text-primary"><%= post.title %></h4>
                <div class="post-meta mb-3">
                    <small class="text-muted">
                        <i class="fas fa-user me-1"></i>By <%= post.author %>
                        <span class="mx-2">â€¢</span>
                        <i class="fas fa-calendar me-1"></i><%= formatDate(post.createdAt) %>
                    </small>
                </div>
                <p class="text-muted">
                    <%= post.content.length > 200 ? post.content.substring(0, 200) + '...' : post.content %>
                </p>
                <a href="/posts/<%= post.id %>" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-external-link-alt me-1"></i>View Full Post
                </a>
            </div>
        </div>
    </div>
</div>

<%- include('partials/footer') %>